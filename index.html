<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Oil Painting Grid</title>
<style>
body,html{margin:0;height:100%;overflow:hidden;font-family:sans-serif;background:#222;color:#fff;display:flex;flex-direction:column}
#ui{display:flex;gap:8px;padding:8px;background:#333}
#ui input[type=range]{width:100px}
#renderArea{flex:1}
button{padding:6px 12px;background:#555;border:none;color:#fff;cursor:pointer}
button:disabled{opacity:.5;cursor:default}
label{display:flex;flex-direction:column;font-size:12px}
</style>
</head>
<body>
<div id="ui">
<label>Color A<input type="color" id="colorA" value="#ff0000"></label>
<label>Color B<input type="color" id="colorB" value="#0000ff"></label>
<label>Mix<input type="range" id="mix" min="0" max="100" value="50"></label>
<label>Brush<input type="range" id="brush" min="1" max="50" value="10"></label>
<button id="selectBtn">Select Section</button>
<span id="time">0</span>
</div>
<div id="renderArea"></div>
<script src="https://cdn.jsdelivr.net/npm/three@0.158/build/three.min.js"></script>
<script>
const size=600,sections=10;
const scene=new THREE.Scene();
const camera=new THREE.OrthographicCamera(-size/2,size/2,size/2,-size/2,1,1000);
camera.position.z=10;
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(size,size);
document.getElementById('renderArea').appendChild(renderer.domElement);
const paintCanvas=document.createElement('canvas');
paintCanvas.width=size;
paintCanvas.height=size;
const ctx=paintCanvas.getContext('2d');
ctx.fillStyle='#ffffff';
ctx.fillRect(0,0,size,size);
ctx.strokeStyle='#cccccc';
for(let i=0;i<=sections;i++){
ctx.beginPath();
ctx.moveTo(0,i*size/sections);
ctx.lineTo(size,i*size/sections);
ctx.stroke();
ctx.beginPath();
ctx.moveTo(i*size/sections,0);
ctx.lineTo(i*size/sections,size);
ctx.stroke();}
const texture=new THREE.CanvasTexture(paintCanvas);
const plane=new THREE.Mesh(new THREE.PlaneGeometry(size,size),new THREE.MeshBasicMaterial({map:texture}));
scene.add(plane);
let painting=false;
let activeCell=null;
let timer=0;
let brush=10;
let interval=null;
function mixColor(c1,c2,ratio){
const r=parseInt(c1.substr(1,2),16)*(1-ratio)+parseInt(c2.substr(1,2),16)*ratio;
const g=parseInt(c1.substr(3,2),16)*(1-ratio)+parseInt(c2.substr(3,2),16)*ratio;
const b=parseInt(c1.substr(5,2),16)*(1-ratio)+parseInt(c2.substr(5,2),16)*ratio;
return`rgb(${r},${g},${b})`;}
function uvToXY(uv){return[(uv.x+0.5)*size,(0.5-uv.y)*size];}
renderer.domElement.addEventListener('pointerdown',e=>{if(!activeCell)return;painting=true;draw(e);});
renderer.domElement.addEventListener('pointermove',e=>{if(painting)draw(e);});
window.addEventListener('pointerup',()=>painting=false);
function draw(e){
const rect=renderer.domElement.getBoundingClientRect();
const x=(e.clientX-rect.left)/rect.width*2-1;
const y=-(e.clientY-rect.top)/rect.height*2+1;
const vector=new THREE.Vector3(x,y,0).unproject(camera);
const uv=plane.worldToLocal(vector);
const[cx,cy]=uvToXY(uv);
const cellX=Math.floor(cx/(size/sections));
const cellY=Math.floor(cy/(size/sections));
if(cellX!==activeCell.x||cellY!==activeCell.y)return;
ctx.fillStyle=mixColor(colorA.value,colorB.value,mix.value/100);
ctx.beginPath();
ctx.arc(cx,cy,brush,0,Math.PI*2);
ctx.fill();
texture.needsUpdate=true;}
function animate(){requestAnimationFrame(animate);renderer.render(scene,camera);}
animate();
selectBtn.onclick=()=>{
selectBtn.disabled=true;
renderer.domElement.style.cursor='crosshair';
renderer.domElement.addEventListener('click',pickSection,{once:true});};
function pickSection(e){
const rect=renderer.domElement.getBoundingClientRect();
const x=(e.clientX-rect.left)/rect.width*2-1;
const y=-(e.clientY-rect.top)/rect.height*2+1;
const vector=new THREE.Vector3(x,y,0).unproject(camera);
const uv=plane.worldToLocal(vector);
const[cx,cy]=uvToXY(uv);
const cellX=Math.floor(cx/(size/sections));
const cellY=Math.floor(cy/(size/sections));
activeCell={x:cellX,y:cellY};
timer=5;
time.textContent=timer;
interval=setInterval(()=>{timer--;time.textContent=timer;if(timer<=0){activeCell=null;clearInterval(interval);selectBtn.disabled=false;renderer.domElement.style.cursor='default';}},1000);}
mix.oninput=()=>{};
brush.oninput=()=>{brush=brush.value};
</script>
</body>
</html>
