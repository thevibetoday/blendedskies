<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Collective Canvas X</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{--pink:#ff00ff;--blue:#00ffff;--green:#39ff14;--bg:#101020}
*{margin:0;padding:0;box-sizing:border-box}
body,html{height:100%;background:var(--bg);font-family:'Space Mono',monospace;color:#fff;overflow:hidden}
#canvas-container{position:relative;width:100%;height:100%}
#hud{position:absolute;top:0;left:0;width:100%;padding:10px;display:flex;flex-wrap:wrap;gap:10px;z-index:10;pointer-events:none}
.hud-block{background:rgba(16,16,32,.85);border:2px solid var(--blue);border-radius:12px;padding:8px 16px;pointer-events:auto}
#palette{display:flex;gap:6px;flex-wrap:wrap}
.color{width:28px;height:28px;border-radius:50%;cursor:pointer;border:2px solid transparent}
.color.active{border-color:#fff}
#brushes{display:flex;gap:6px}
.brush{width:28px;height:28px;border-radius:50%;background:rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center;cursor:pointer;border:2px solid transparent}
.brush div{border-radius:50%;background:#fff}
.brush.active{border-color:#fff}
#timer{font-size:1.6rem;font-weight:700;text-shadow:0 0 8px var(--pink)}
#intro,#selector{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:20px;background:rgba(16,16,32,.95);z-index:20}
button{padding:12px 32px;border:none;border-radius:50px;font-family:'Space Mono',monospace;font-size:1rem;text-transform:uppercase;font-weight:700;letter-spacing:2px;cursor:pointer;background:linear-gradient(45deg,var(--pink),var(--blue));color:#fff;box-shadow:0 0 15px rgba(255,0,255,.5);transition:transform .3s,box-shadow .3s}
button:hover{transform:scale(1.05);box-shadow:0 0 22px rgba(255,0,255,.8)}
#grid{display:grid;gap:10px;width:min(80vw,600px);max-height:70vh;overflow:auto;padding:20px}
.cell{width:80px;height:80px;background:rgba(255,255,255,.06);border:2px solid rgba(255,255,255,.2);border-radius:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:.3s;position:relative}
.cell:hover{background:rgba(255,255,255,.15);transform:scale(1.05);box-shadow:0 0 12px var(--blue)}
.cell.occ{border-color:var(--pink)}
.cell.occ::before{content:'';position:absolute;inset:0;background:linear-gradient(45deg,rgba(255,0,255,.25),transparent)}
@media(max-width:600px){.cell{width:60px;height:60px}}
</style>
</head>
<body>
<div id="canvas-container"></div>
<div id="hud">
<div id="palette" class="hud-block"></div>
<div id="brushes" class="hud-block"></div>
<div id="timer" class="hud-block" style="display:none">5</div>
</div>
<div id="intro">
<h1 style="font-size:3rem;text-shadow:0 0 15px var(--pink),0 0 30px var(--blue)">Collective Canvas X</h1>
<p style="max-width:520px;text-align:center;line-height:1.6">Paint a global masterpiece one tile at a time. Mix vivid oils, wield expressive brushes and leave your mark.</p>
<button id="start">Begin</button>
</div>
<div id="selector" style="display:none">
<h2 style="font-size:2rem;text-shadow:0 0 10px var(--green)">Select Your Section</h2>
<div id="grid"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/three@0.158/build/three.min.js"></script>
<script>
const GRID=10,PLANE=10,SECTIONS=GRID*GRID,paintColors=[{n:'Cadmium Red',h:'#E30022'},{n:'Alizarin Crimson',h:'#E34234'},{n:'Cadmium Yellow',h:'#FFF600'},{n:'Yellow Ochre',h:'#CB9D06'},{n:'Ultramarine',h:'#0A1172'},{n:'Cobalt',h:'#0047AB'},{n:'Cerulean',h:'#2A52BE'},{n:'Phthalo',h:'#000F89'},{n:'Viridian',h:'#40826D'},{n:'Sap',h:'#507D2A'},{n:'Burnt Sienna',h:'#E97451'},{n:'Burnt Umber',h:'#8A3324'},{n:'Raw Umber',h:'#826644'},{n:'Titanium',h:'#FFFFFF'},{n:'Ivory',h:'#1B1B1B'},{n:'Magenta',h:'#FF00FF'},{n:'Cyan',h:'#00FFFF'},{n:'Neon Green',h:'#39FF14'}];
const container=document.getElementById('canvas-container');
const scene=new THREE.Scene();
const camera=new THREE.OrthographicCamera(-PLANE/2,PLANE/2,PLANE/2,-PLANE/2,0.1,100);camera.position.z=5;
const renderer=new THREE.WebGLRenderer({antialias:true});renderer.setSize(window.innerWidth,window.innerHeight);container.appendChild(renderer.domElement);
const offCanvas=document.createElement('canvas');offCanvas.width=2048;offCanvas.height=2048;const offCtx=offCanvas.getContext('2d');offCtx.fillStyle='#ffffff';offCtx.fillRect(0,0,offCanvas.width,offCanvas.height);
const tex=new THREE.CanvasTexture(offCanvas);tex.minFilter=THREE.LinearFilter;
const plane=new THREE.Mesh(new THREE.PlaneGeometry(PLANE,PLANE),new THREE.MeshBasicMaterial({map:tex}));scene.add(plane);
window.addEventListener('resize',()=>{renderer.setSize(window.innerWidth,window.innerHeight)});
const paletteDiv=document.getElementById('palette');paintColors.forEach(c=>{const d=document.createElement('div');d.className='color';d.style.background=c.h;d.dataset.color=c.h;paletteDiv.appendChild(d)});
let currentColor=paintColors[0].h;document.querySelector('.color').classList.add('active');
paletteDiv.addEventListener('click',e=>{if(e.target.classList.contains('color')){document.querySelectorAll('.color').forEach(n=>n.classList.remove('active'));e.target.classList.add('active');currentColor=e.target.dataset.color}});
const brushesDiv=document.getElementById('brushes'),sizes=[0.025,0.05,0.1,0.2];sizes.forEach(s=>{const b=document.createElement('div');b.className='brush';b.dataset.size=s;const inner=document.createElement('div');inner.style.width=inner.style.height=`${s*100}px`;b.appendChild(inner);brushesDiv.appendChild(b)});
let brushSize=sizes[1];document.querySelectorAll('.brush')[1].classList.add('active');
brushesDiv.addEventListener('click',e=>{const b=e.target.closest('.brush');if(b){document.querySelectorAll('.brush').forEach(n=>n.classList.remove('active'));b.classList.add('active');brushSize=parseFloat(b.dataset.size)}});
const intro=document.getElementById('intro'),startBtn=document.getElementById('start'),selector=document.getElementById('selector'),gridDiv=document.getElementById('grid');
const occupancy=Array(SECTIONS).fill(0).map(()=>Math.floor(Math.random()*3));
startBtn.onclick=()=>{intro.style.display='none';selector.style.display='flex';buildGrid()};
function buildGrid(){gridDiv.style.gridTemplateColumns=`repeat(${Math.min(5,GRID)},1fr)`;for(let i=0;i<SECTIONS;i++){const c=document.createElement('div');c.className='cell'+(occupancy[i]?' occ':'');c.innerHTML=`<span>${i+1}</span><small>${occupancy[i]} artists</small>`;c.dataset.i=i;c.onclick=()=>selectSection(i);gridDiv.appendChild(c)}}
let currentSection=null,inQueue=false,queuePos=0,totalPainters=occupancy.reduce((a,b)=>a+b,0);
function selectSection(i){selector.style.display='none';inQueue=true;queuePos=occupancy[i]+1;advanceQueue(i)}
function advanceQueue(i){const bar=document.createElement('div');bar.style.position='absolute';bar.style.bottom='30px';bar.style.left='50%';bar.style.transform='translateX(-50%)';bar.style.width='60%';bar.style.height='8px';bar.style.background='rgba(255,255,255,.15)';bar.style.borderRadius='4px';bar.style.overflow='hidden';bar.style.zIndex=15;const fill=document.createElement('div');fill.style.height='100%';fill.style.width='0%';fill.style.background='linear-gradient(90deg,var(--pink),var(--blue))';fill.style.transition='width .3s';bar.appendChild(fill);document.body.appendChild(bar);let prog=0;const iv=setInterval(()=>{prog+=5;fill.style.width=`${prog}%`;if(prog>=100){clearInterval(iv);bar.remove();inQueue=false;currentSection=i;occupancy[i]++;totalPainters++;activateSection()}},100)}
const timerEl=document.getElementById('timer');let painting=false,timeLeft=5,timerIv=null;
function activateSection(){timerEl.style.display='block';timerEl.textContent=timeLeft}
function toUV(px,py){const rect=renderer.domElement.getBoundingClientRect();return[(px-rect.left)/rect.width,(py-rect.top)/rect.height]}
function pointerDown(px,py){if(inQueue||currentSection===null)return;const[ua,va]=toUV(px,py);const x=(ua-.5)*PLANE,y=(.5-va)*PLANE;if(!insideSection(x,y))return;painting=true;startTimer();paint(x,y)}
function pointerMove(px,py){if(!painting)return;const[ua,va]=toUV(px,py);const x=(ua-.5)*PLANE,y=(.5-va)*PLANE;if(!insideSection(x,y))return;paint(x,y)}
function pointerUp(){painting=false;clearInterval(timerIv);timerEl.style.display='none';timeLeft=5}
function insideSection(x,y){const w=PLANE/GRID,h=w;const row=Math.floor((y+PLANE/2)/h),col=Math.floor((x+PLANE/2)/w);return currentSection===row*GRID+col}
function startTimer(){timerEl.textContent=timeLeft;clearInterval(timerIv);timerIv=setInterval(()=>{timeLeft--;timerEl.textContent=timeLeft;if(timeLeft<=0){pointerUp()}},1000)}
function paint(x,y){const w=offCanvas.width/GRID,h=offCanvas.height/GRID;const row=Math.floor((y+PLANE/2)/(PLANE/GRID)),col=Math.floor((x+PLANE/2)/(PLANE/GRID));const jitter=brushSize*offCanvas.width*0.02;const cx=col*w+(x%(PLANE/GRID))/(PLANE/GRID)*w;const cy=row*h+(y%(PLANE/GRID))/(PLANE/GRID)*h;const bx=cx+Math.random()*jitter-jitter/2;const by=cy+Math.random()*jitter-jitter/2;offCtx.fillStyle=currentColor;offCtx.beginPath();offCtx.arc(bx,offCanvas.height-by,brushSize*offCanvas.width,0,Math.PI*2);offCtx.fill();tex.needsUpdate=true}
renderer.domElement.addEventListener('pointerdown',e=>pointerDown(e.clientX,e.clientY));renderer.domElement.addEventListener('pointermove',e=>pointerMove(e.clientX,e.clientY));window.addEventListener('pointerup',pointerUp);
function loop(){renderer.render(scene,camera);requestAnimationFrame(loop)}loop();
</script>
</body>
</html>
