<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blend of Skies</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            overflow-x: hidden;
            background: #2c3e50;
            color: white;
        }
        
        .sky-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(to bottom, #1e3c72, #2a5298);
            transition: background 1.5s ease;
            overflow: hidden;
        }
        
        .celestial-object {
            position: absolute;
            transition: all 2s cubic-bezier(0.25, 1, 0.5, 1);
        }
        
        .sun {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #fffc00 20%, #ff9500);
            border-radius: 50%;
            box-shadow: 0 0 50px #ff7b00;
            opacity: 1;
            left: 20%;
            top: -100px;
        }
        
        .moon {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, #dddddd, #bbbbbb);
            border-radius: 50%;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
            opacity: 0;
            right: 15%;
            top: -100px;
        }
        
        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            opacity: 0;
            transition: all 2s ease;
        }
        
        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            opacity: 0;
            box-shadow: 0 0 3px white;
            transition: opacity 2s ease;
        }
        
        .raindrop {
            position: absolute;
            width: 1px;
            height: 15px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .snow {
            position: absolute;
            width: 5px;
            height: 5px;
            background: white;
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .lightning {
            position: absolute;
            width: 3px;
            background: white;
            opacity: 0;
            filter: blur(1px);
            box-shadow: 0 0 20px white, 0 0 40px white;
            transform-origin: top;
            z-index: 0;
            transition: opacity 0.1s ease;
        }
        
        .rainbow {
            position: absolute;
            width: 400px;
            height: 200px;
            border-top-left-radius: 200px;
            border-top-right-radius: 200px;
            background: linear-gradient(to bottom, 
                rgba(255, 0, 0, 0.5), 
                rgba(255, 165, 0, 0.5), 
                rgba(255, 255, 0, 0.5), 
                rgba(0, 128, 0, 0.5), 
                rgba(0, 0, 255, 0.5), 
                rgba(75, 0, 130, 0.5), 
                rgba(238, 130, 238, 0.5));
            border: none;
            opacity: 0;
            left: 50%;
            bottom: -150px;
            transform: translateX(-50%) rotate(180deg);
            transition: all 2s ease;
        }
        
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            z-index: 10;
            position: relative;
        }
        
        .brand {
            font-size: 24px;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .question-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 0 20px;
            position: relative;
            z-index: 10;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }
        
        .question-container.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .question-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        .question-subtitle {
            font-size: 1.2rem;
            margin-bottom: 50px;
            max-width: 600px;
            opacity: 0.9;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }
        
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            max-width: 800px;
            width: 100%;
        }
        
        .option-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .option-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.25);
        }
        
        .option-card.selected {
            border-color: white;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }
        
        .option-icon {
            font-size: 32px;
            margin-bottom: 15px;
            transition: transform 0.3s ease;
        }
        
        .option-card:hover .option-icon {
            transform: scale(1.2);
        }
        
        .option-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .option-description {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .navigation {
            position: fixed;
            bottom: 30px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 40px;
            z-index: 100;
        }
        
        .nav-button {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: none;
            color: white;
            padding: 12px 30px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        
        .nav-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-3px);
        }
        
        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: translateY(0);
        }
        
        .progress-indicator {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 100;
        }
        
        .progress-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .progress-dot.active {
            background: white;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .results-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 0 20px;
            position: relative;
            z-index: 10;
            opacity: 0;
            visibility: hidden;
            transition: opacity 1s ease, visibility 1s ease;
        }
        
        .results-container.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .results-icon {
            font-size: 80px;
            margin-bottom: 30px;
            animation: pulse 3s infinite;
        }
        
        .results-title {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        .results-description {
            font-size: 1.3rem;
            max-width: 700px;
            margin-bottom: 40px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }
        
        .restart-button {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid white;
            color: white;
            padding: 15px 40px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }
        
        .restart-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.9; }
        }
        
        @keyframes rain {
            0% { transform: translateY(-100px); }
            100% { transform: translateY(1000px); }
        }
        
        @keyframes snow {
            0% { transform: translateY(-100px) rotate(0deg); }
            100% { transform: translateY(1000px) rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
            
            .question-title {
                font-size: 2rem;
            }
            
            .option-title {
                font-size: 1.1rem;
            }
            
            .results-title {
                font-size: 2.5rem;
            }
            
            .results-description {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="sky-canvas" id="sky-canvas">
        <div class="celestial-object sun" id="sun"></div>
        <div class="celestial-object moon" id="moon"></div>
        <div class="rainbow" id="rainbow"></div>
        <!-- Weather elements will be added dynamically via JS -->
    </div>
    
    <nav class="navbar">
        <div class="brand">Blend of Skies</div>
    </nav>
    
    <div class="progress-indicator" id="progress-indicator">
        <!-- Progress dots will be added dynamically -->
    </div>
    
    <div id="questions-container">
        <!-- Questions will be generated dynamically -->
    </div>
    
    <div class="results-container" id="results-container">
        <div class="results-icon" id="results-icon">‚ú®</div>
        <h1 class="results-title" id="results-title">Your Sky Personality</h1>
        <p class="results-description" id="results-description">Based on your choices, we've created a unique sky that reflects your personality.</p>
        <button class="restart-button" id="restart-button">Start Again</button>
    </div>
    
    <div class="navigation">
        <button class="nav-button" id="prev-button" disabled>Previous</button>
        <button class="nav-button" id="next-button">Next</button>
    </div>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Sky elements
        const skyCanvas = document.getElementById('sky-canvas');
        const sun = document.getElementById('sun');
        const moon = document.getElementById('moon');
        const rainbow = document.getElementById('rainbow');
        
        // Navigation elements
        const questionsContainer = document.getElementById('questions-container');
        const resultsContainer = document.getElementById('results-container');
        const prevButton = document.getElementById('prev-button');
        const nextButton = document.getElementById('next-button');
        const progressIndicator = document.getElementById('progress-indicator');
        const restartButton = document.getElementById('restart-button');
        
        // Results elements
        const resultsIcon = document.getElementById('results-icon');
        const resultsTitle = document.getElementById('results-title');
        const resultsDescription = document.getElementById('results-description');
        
        // State management
        let currentQuestion = 0;
        let userAnswers = {};
        
        // Define all questions
        const questions = [
            {
                id: 'time',
                title: "What time of day speaks to your soul?",
                subtitle: "Choose the sky phase that resonates with your natural rhythm",
                options: [
                    {
                        id: 'dawn',
                        icon: 'üåÖ',
                        title: 'Dawn',
                        description: 'Early riser, fresh starts, new beginnings',
                        skyEffect: {
                            background: 'linear-gradient(to bottom, #ff9966, #ff5e62)',
                            sun: { visible: true, position: { left: '20%', top: '20%' } },
                            moon: { visible: false },
                            clouds: { amount: 'few', color: '#ffcccb' },
                            stars: { visible: false }
                        }
                    },
                    {
                        id: 'midday',
                        icon: '‚òÄÔ∏è',
                        title: 'Midday',
                        description: 'Peak energy, clarity, productivity, directness',
                        skyEffect: {
                            background: 'linear-gradient(to bottom, #1e90ff, #87ceeb)',
                            sun: { visible: true, position: { left: '50%', top: '15%' } },
                            moon: { visible: false },
                            clouds: { amount: 'few', color: 'white' },
                            stars: { visible: false }
                        }
                    },
                    {
                        id: 'sunset',
                        icon: 'üåá',
                        title: 'Sunset',
                        description: 'Reflective, romantic, winding down, transitional',
                        skyEffect: {
                            background: 'linear-gradient(to bottom, #ff7e5f, #feb47b)',
                            sun: { visible: true, position: { left: '80%', top: '30%' } },
                            moon: { visible: false },
                            clouds: { amount: 'moderate', color: '#ffd700' },
                            stars: { visible: false }
                        }
                    },
                    {
                        id: 'night',
                        icon: 'üåÉ',
                        title: 'Night',
                        description: 'Mysterious, deep thinking, creative, magical',
                        skyEffect: {
                            background: 'linear-gradient(to bottom, #0f2027, #203a43, #2c5364)',
                            sun: { visible: false },
                            moon: { visible: true, position: { right: '30%', top: '20%' } },
                            clouds: { amount: 'few', color: '#555' },
                            stars: { visible: true, amount: 'many' }
                        }
                    }
                ]
            },
            {
                id: 'weather',
                title: "What weather matches your temperament?",
                subtitle: "Select the atmospheric condition that best represents you",
                options: [
                    {
                        id: 'clear',
                        icon: '‚òÄÔ∏è',
                        title: 'Clear Skies',
                        description: 'Straightforward, optimistic, nothing to hide',
                        skyEffect: {
                            clouds: { amount: 'none' },
                            rain: { visible: false },
                            snow: { visible: false },
                            lightning: { visible: false }
                        }
                    },
                    {
                        id: 'cloudy',
                        icon: '‚õÖ',
                        title: 'Partly Cloudy',
                        description: 'Balanced, thoughtful, adaptable, changing',
                        skyEffect: {
                            clouds: { amount: 'moderate', color: 'white' },
                            rain: { visible: false },
                            snow: { visible: false },
                            lightning: { visible: false }
                        }
                    },
                    {
                        id: 'rainy',
                        icon: 'üåßÔ∏è',
                        title: 'Rainy',
                        description: 'Emotional, introspective, cleansing, thoughtful',
                        skyEffect: {
                            clouds: { amount: 'many', color: '#888' },
                            rain: { visible: true, intensity: 'moderate' },
                            snow: { visible: false },
                            lightning: { visible: false }
                        }
                    },
                    {
                        id: 'stormy',
                        icon: '‚õàÔ∏è',
                        title: 'Thunderstorm',
                        description: 'Passionate, intense, powerful, dynamic',
                        skyEffect: {
                            clouds: { amount: 'many', color: '#555' },
                            rain: { visible: true, intensity: 'heavy' },
                            snow: { visible: false },
                            lightning: { visible: true }
                        }
                    },
                    {
                        id: 'snowy',
                        icon: '‚ùÑÔ∏è',
                        title: 'Snowy',
                        description: 'Gentle, quiet, peaceful, pristine',
                        skyEffect: {
                            clouds: { amount: 'many', color: '#ccc' },
                            rain: { visible: false },
                            snow: { visible: true },
                            lightning: { visible: false }
                        }
                    }
                ]
            },
            {
                id: 'element',
                title: "What elemental force guides you?",
                subtitle: "Choose the natural element that shapes your interactions",
                options: [
                    {
                        id: 'air',
                        icon: 'üí®',
                        title: 'Air',
                        description: 'Free-spirited, intellectual, communicative',
                        skyEffect: {
                            clouds: { amount: 'few', motion: 'fast' }
                        }
                    },
                    {
                        id: 'fire',
                        icon: 'üî•',
                        title: 'Fire',
                        description: 'Passionate, energetic, transformative',
                        skyEffect: {
                            background: 'linear-gradient(to bottom, #ff416c, #ff4b2b)',
                            sun: { visible: true, size: 'large' }
                        }
                    },
                    {
                        id: 'water',
                        icon: 'üíß',
                        title: 'Water',
                        description: 'Fluid, intuitive, emotional, adaptable',
                        skyEffect: {
                            background: 'linear-gradient(to bottom, #4ca1af, #c4e0e5)',
                            rain: { visible: true, intensity: 'light' }
                        }
                    },
                    {
                        id: 'earth',
                        icon: 'üå±',
                        title: 'Earth',
                        description: 'Grounded, practical, reliable, nurturing',
                        skyEffect: {
                            background: 'linear-gradient(to bottom, #76b852, #8dc26f)',
                            rainbow: { visible: true }
                        }
                    }
                ]
            },
            {
                id: 'energy',
                title: "What energy level drives your day?",
                subtitle: "Select the atmospheric intensity that matches your pace",
                options: [
                    {
                        id: 'calm',
                        icon: 'üå§Ô∏è',
                        title: 'Calm & Serene',
                        description: 'Peaceful, mindful, unhurried, present',
                        skyEffect: {
                            clouds: { amount: 'few', motion: 'slow' },
                            background: 'linear-gradient(to bottom, #2980b9, #6dd5fa)'
                        }
                    },
                    {
                        id: 'vibrant',
                        icon: 'üåà',
                        title: 'Vibrant & Lively',
                        description: 'Energetic, colorful, expressive, enthusiastic',
                        skyEffect: {
                            rainbow: { visible: true },
                            background: 'linear-gradient(to bottom, #00b09b, #96c93d)'
                        }
                    },
                    {
                        id: 'intense',
                        icon: '‚ö°',
                        title: 'Intense & Focused',
                        description: 'Driven, determined, powerful, single-minded',
                        skyEffect: {
                            lightning: { visible: true, frequency: 'occasional' },
                            background: 'linear-gradient(to bottom, #373b44, #4286f4)'
                        }
                    },
                    {
                        id: 'mellow',
                        icon: 'üåô',
                        title: 'Mellow & Contemplative',
                        description: 'Thoughtful, relaxed, introspective, measured',
                        skyEffect: {
                            moon: { visible: true },
                            stars: { visible: true, amount: 'moderate' },
                            background: 'linear-gradient(to bottom, #141e30, #243b55)'
                        }
                    }
                ]
            },
            {
                id: 'horizon',
                title: "How far do you look into the distance?",
                subtitle: "Choose the view that reflects your perspective on life",
                options: [
                    {
                        id: 'immediate',
                        icon: 'üëÅÔ∏è',
                        title: 'Immediate Focus',
                        description: 'Present-oriented, detail-focused, hands-on',
                        skyEffect: {
                            clouds: { amount: 'many', height: 'low' }
                        }
                    },
                    {
                        id: 'balanced',
                        icon: '‚öñÔ∏è',
                        title: 'Balanced View',
                        description: 'Adaptable, practical, realistic, flexible',
                        skyEffect: {
                            clouds: { amount: 'moderate', height: 'medium' }
                        }
                    },
                    {
                        id: 'farSighted',
                        icon: 'üî≠',
                        title: 'Far Horizon',
                        description: 'Visionary, big-picture thinker, future-focused',
                        skyEffect: {
                            clouds: { amount: 'few', height: 'high' },
                            stars: { visible: true, amount: 'few' }
                        }
                    },
                    {
                        id: 'cosmic',
                        icon: '‚ú®',
                        title: 'Cosmic Perspective',
                        description: 'Philosophical, boundless, spiritual, expansive',
                        skyEffect: {
                            stars: { visible: true, amount: 'many' },
                            background: 'linear-gradient(to bottom, #000428, #004e92)'
                        }
                    }
                ]
            }
        ];
        
        // Sky personality profiles based on answers
        const skyProfiles = [
            {
                name: "Dawn Explorer",
                description: "You're an optimistic pioneer with boundless energy for new beginnings. Like the first light of dawn, you bring fresh perspective and clarity to everything you touch.",
                icon: "üåÖ",
                matches: {
                    time: ["dawn"],
                    energy: ["vibrant", "intense"],
                    horizon: ["farSighted", "cosmic"]
                }
            },
            {
                name: "Serene Drifter",
                description: "Peaceful and contemplative, you move through life with grace. Like clouds on a clear day, you adapt to change while maintaining your essential nature.",
                icon: "‚õÖ",
                matches: {
                    weather: ["clear", "cloudy"],
                    energy: ["calm", "mellow"],
                    element: ["air", "water"]
                }
            },
            {
                name: "Electric Visionary",
                description: "Powerfully charged and intensely focused, you cut through obstacles like lightning through the sky. Your energy is both inspiring and transformative.",
                icon: "‚ö°",
                matches: {
                    weather: ["stormy"],
                    energy: ["intense"],
                    element: ["fire"]
                }
            },
            {
                name: "Twilight Dreamer",
                description: "Like the magical transition of sunset, you thrive in the in-between moments. You see beauty in change and possibility in transitions.",
                icon: "üåá",
                matches: {
                    time: ["sunset"],
                    energy: ["mellow"],
                    horizon: ["farSighted"]
                }
            },
            {
                name: "Celestial Thinker",
                description: "Deep and mysterious like the night sky, your mind contains vast constellations of ideas. You see patterns others miss and find comfort in life's deeper questions.",
                icon: "üåå",
                matches: {
                    time: ["night"],
                    horizon: ["cosmic"],
                    energy: ["mellow"]
                }
            },
            {
                name: "Vibrant Rainbow",
                description: "Diverse, colorful, and appearing after life's storms, you bring joy and perspective. Your presence signals hope and your personality contains multitudes.",
                icon: "üåà",
                matches: {
                    energy: ["vibrant"],
                    weather: ["rainy"],
                    element: ["water"]
                }
            },
            {
                name: "Grounded Sunbeam",
                description: "Practical yet warm, you shine consistent light on those around you. Your reliable energy and clear perspective makes you a cornerstone for others.",
                icon: "‚òÄÔ∏è",
                matches: {
                    time: ["midday"],
                    weather: ["clear"],
                    element: ["earth", "fire"]
                }
            },
            {
                name: "Gentle Snowfall",
                description: "Quiet and transformative, you create space for reflection. Your gentle presence changes landscapes and invites others to see the world anew.",
                icon: "‚ùÑÔ∏è",
                matches: {
                    weather: ["snowy"],
                    energy: ["calm"],
                    element: ["water"]
                }
            }
        ];
        
        // Initialize sky elements and event listeners
        function initialize() {
            createProgressIndicator();
            renderQuestion(currentQuestion);
            createInitialSkyElements();
            
            prevButton.addEventListener('click', navigateToPrevious);
            nextButton.addEventListener('click', navigateToNext);
            restartButton.addEventListener('click', restartQuiz);
        }
        
        // Create initial clouds, stars, and weather elements
        function createInitialSkyElements() {
            // Create clouds
            for (let i = 0; i < 5; i++) {
                createCloud();
            }
            
            // Create stars
            for (let i = 0; i < 50; i++) {
                createStar();
            }
        }
        
        // Create a single cloud element
        function createCloud() {
            const cloud = document.createElement('div');
            cloud.className = 'cloud';
            
            // Random size between 50px and 150px
            const size = Math.random() * 100 + 50;
            cloud.style.width = `${size}px`;
            cloud.style.height = `${size * 0.6}px`;
            
            // Random position
            cloud.style.left = `${Math.random() * 100}%`;
            cloud.style.top = `${Math.random() * 20 + 10}%`;
            
            // Add the cloud to the sky
            skyCanvas.appendChild(cloud);
            return cloud;
        }
        
        // Create a single star element
        function createStar() {
            const star = document.createElement('div');
            star.className = 'star';
            
            // Random position
            star.style.left = `${Math.random() * 100}%`;
            star.style.top = `${Math.random() * 60}%`;
            
            // Random size between 1px and 3px
            const size = Math.random() * 2 + 1;
            star.style.width = `${size}px`;
            star.style.height = `${size}px`;
            
            // Add the star to the sky
            skyCanvas.appendChild(star);
            return star;
        }
        
        // Create a raindrop element
        function createRaindrop() {
            const raindrop = document.createElement('div');
            raindrop.className = 'raindrop';
            
            // Random position
            raindrop.style.left = `${Math.random() * 100}%`;
            raindrop.style.top = '0%';
            
            // Add the raindrop to the sky
            skyCanvas.appendChild(raindrop);
            
            return raindrop;
        }
        
        // Create a snowflake element
        function createSnowflake() {
            const snowflake = document.createElement('div');
            snowflake.className = 'snow';
            
            // Random position
            snowflake.style.left = `${Math.random() * 100}%`;
            snowflake.style.top = '0%';
            
            // Add the snowflake to the sky
            skyCanvas.appendChild(snowflake);
            return snowflake;
        }
        
        // Create a lightning element
        function createLightning() {
            const lightning = document.createElement('div');
            lightning.className = 'lightning';
            
            // Random position
            const leftPos = Math.random() * 80 + 10;
            lightning.style.left = `${leftPos}%`;
            lightning.style.top = '0%';
            
            // Random height and width
            const height = Math.random() * 300 + 100;
            lightning.style.height = `${height}px`;
            
            // Add the lightning to the sky
            skyCanvas.appendChild(lightning);
            
            // Animate the lightning
            setTimeout(() => {
                lightning.style.opacity = 0.8;
                
                setTimeout(() => {
                    lightning.style.opacity = 0;
                    
                    // Remove after animation
                    setTimeout(() => {
                        skyCanvas.removeChild(lightning);
                    }, 100);
                }, 100);
            }, 10);
        }
        
        // Create progress indicator dots
        function createProgressIndicator() {
            for (let i = 0; i < questions.length; i++) {
                const dot = document.createElement('div');
                dot.className = i === 0 ? 'progress-dot active' : 'progress-dot';
                progressIndicator.appendChild(dot);
            }
        }
        
        // Render a specific question
        function renderQuestion(index) {
            // Clear previous questions
            questionsContainer.innerHTML = '';
            
            const question = questions[index];
            
            // Create question container
            const questionElement = document.createElement('div');
            questionElement.className = 'question-container';
            questionElement.id = `question-${question.id}`;
            
            // Create question content
            questionElement.innerHTML = `
                <h2 class="question-title">${question.title}</h2>
                <p class="question-subtitle">${question.subtitle}</p>
                <div class="options-grid" id="options-${question.id}">
                    ${question.options.map(option => `
                        <div class="option-card" data-option-id="${option.id}">
                            <div class="option-icon">${option.icon}</div>
                            <h3 class="option-title">${option.title}</h3>
                            <p class="option-description">${option.description}</p>
                        </div>
                    `).join('')}
                </div>
            `;
            
            // Add to container
            questionsContainer.appendChild(questionElement);
            
            // Add event listeners to options
            const optionCards = questionElement.querySelectorAll('.option-card');
            optionCards.forEach(card => {
                card.addEventListener('click', () => {
                    // Deselect all options
                    optionCards.forEach(c => c.classList.remove('selected'));
                    
                    // Select this option
                    card.classList.add('selected');
                    
                    // Save the answer
                    const optionId = card.getAttribute('data-option-id');
                    userAnswers[question.id] = optionId;
                    
                    // Apply sky effect
                    const selectedOption = question.options.find(o => o.id === optionId);
                    applySkyEffect(selectedOption.skyEffect);
                    
                    // Enable next button if disabled
                    nextButton.disabled = false;
                });
            });
            
            // Check if this question was already answered
            if (userAnswers[question.id]) {
                const selectedOption = questionElement.querySelector(`.option-card[data-option-id="${userAnswers[question.id]}"]`);
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                }
            }
            
            // Make question visible after a short delay
            setTimeout(() => {
                questionElement.classList.add('visible');
            }, 100);
            
            // Update navigation buttons
            updateNavigationButtons();
            
            // Update progress indicator
            updateProgressIndicator();
        }
        
        // Apply sky effects based on selected option
        function applySkyEffect(effect) {
            if (!effect) return;
            
            // Background effect
            if (effect.background) {
                skyCanvas.style.background = effect.background;
            }
            
            // Sun effect
            if (effect.sun) {
                if (effect.sun.visible) {
                    sun.style.opacity = 1;
                    if (effect.sun.position) {
                        if (effect.sun.position.left) sun.style.left = effect.sun.position.left;
                        if (effect.sun.position.top) sun.style.top = effect.sun.position.top;
                    }
                    if (effect.sun.size === 'large') {
                        sun.style.width = '100px';
                        sun.style.height = '100px';
                    } else {
                        sun.style.width = '80px';
                        sun.style.height = '80px';
                    }
                } else {
                    sun.style.opacity = 0;
                }
            }
            
            // Moon effect
            if (effect.moon) {
                if (effect.moon.visible) {
                    moon.style.opacity = 1;
                    if (effect.moon.position) {
                        if (effect.moon.position.right) moon.style.right = effect.moon.position.right;
                        if (effect.moon.position.top) moon.style.top = effect.moon.position.top;
                    }
                } else {
                    moon.style.opacity = 0;
                }
            }
            
            // Cloud effect
            if (effect.clouds) {
                // Remove existing clouds
                document.querySelectorAll('.cloud').forEach(cloud => {
                    cloud.style.opacity = 0;
                    setTimeout(() => {
                        if (cloud.parentNode) {
                            cloud.parentNode.removeChild(cloud);
                        }
                    }, 1000);
                });
                
                let cloudCount = 0;
                
                if (effect.clouds.amount === 'few') cloudCount = 3;
                else if (effect.clouds.amount === 'moderate') cloudCount = 8;
                else if (effect.clouds.amount === 'many') cloudCount = 15;
                
                // Create new clouds
                for (let i = 0; i < cloudCount; i++) {
                    const cloud = createCloud();
                    
                    if (effect.clouds.color) {
                        cloud.style.background = effect.clouds.color;
                    }
                    
                    if (effect.clouds.height === 'low') {
                        cloud.style.top = `${Math.random() * 10 + 30}%`;
                    } else if (effect.clouds.height === 'medium') {
                        cloud.style.top = `${Math.random() * 10 + 20}%`;
                    } else if (effect.clouds.height === 'high') {
                        cloud.style.top = `${Math.random() * 10 + 10}%`;
                    }
                    
                    // Make cloud visible
                    setTimeout(() => {
                        cloud.style.opacity = 0.8;
                    }, i * 100);
                    
                    // Add motion to clouds if specified
                    if (effect.clouds.motion) {
                        const direction = Math.random() > 0.5 ? 1 : -1;
                        const speed = effect.clouds.motion === 'fast' ? 30 : 10;
                        
                        setInterval(() => {
                            const currentLeft = parseFloat(cloud.style.left);
                            let newLeft = currentLeft + (direction * speed / 100);
                            
                            if (newLeft > 110) newLeft = -10;
                            if (newLeft < -10) newLeft = 110;
                            
                            cloud.style.left = `${newLeft}%`;
                        }, 1000);
                    }
                }
            }
            
            // Star effect
            if (effect.stars) {
                const stars = document.querySelectorAll('.star');
                
                stars.forEach(star => {
                    star.style.opacity = effect.stars.visible ? 0.8 : 0;
                });
                
                if (effect.stars.visible && effect.stars.amount === 'many') {
                    // Add more stars
                    for (let i = 0; i < 30; i++) {
                        const star = createStar();
                        setTimeout(() => {
                            star.style.opacity = 0.8;
                        }, i * 50);
                    }
                }
            }
            
            // Rain effect
            if (effect.rain) {
                if (effect.rain.visible) {
                    // Create raindrops
                    const intensity = effect.rain.intensity === 'heavy' ? 50 : 
                                       effect.rain.intensity === 'moderate' ? 30 : 15;
                    
                    const rainInterval = setInterval(() => {
                        const raindrop = createRaindrop();
                        raindrop.style.opacity = 0.7;
                        
                        // Animate raindrop
                        raindrop.style.animation = `rain ${Math.random() * 1 + 1}s linear`;
                        
                        // Remove raindrop after animation
                        setTimeout(() => {
                            if (raindrop.parentNode) {
                                raindrop.parentNode.removeChild(raindrop);
                            }
                        }, 2000);
                    }, 2000 / intensity);
                    
                    // Store the interval to clear it later
                    window.rainInterval = rainInterval;
                } else {
                    // Stop rain animation
                    if (window.rainInterval) {
                        clearInterval(window.rainInterval);
                    }
                }
            }
            
            // Snow effect
            if (effect.snow) {
                if (effect.snow.visible) {
                    // Create snowflakes
                    const snowInterval = setInterval(() => {
                        const snowflake = createSnowflake();
                        snowflake.style.opacity = 0.9;
                        
                        // Animate snowflake
                        snowflake.style.animation = `snow ${Math.random() * 5 + 5}s linear`;
                        
                        // Remove snowflake after animation
                        setTimeout(() => {
                            if (snowflake.parentNode) {
                                snowflake.parentNode.removeChild(snowflake);
                            }
                        }, 10000);
                    }, 200);
                    
                    // Store the interval to clear it later
                    window.snowInterval = snowInterval;
                } else {
                    // Stop snow animation
                    if (window.snowInterval) {
                        clearInterval(window.snowInterval);
                    }
                }
            }
            
            // Lightning effect
            if (effect.lightning) {
                if (effect.lightning.visible) {
                    // Create lightning at random intervals
                    const lightningInterval = setInterval(() => {
                        if (Math.random() > 0.7) {
                            createLightning();
                        }
                    }, 3000);
                    
                    // Store the interval to clear it later
                    window.lightningInterval = lightningInterval;
                } else {
                    // Stop lightning animation
                    if (window.lightningInterval) {
                        clearInterval(window.lightningInterval);
                    }
                }
            }
            
            // Rainbow effect
            if (effect.rainbow) {
                rainbow.style.opacity = effect.rainbow.visible ? 0.7 : 0;
                if (effect.rainbow.visible) {
                    rainbow.style.bottom = '20%';
                } else {
                    rainbow.style.bottom = '-150px';
                }
            }
        }
        
        // Update navigation buttons based on current question
        function updateNavigationButtons() {
            prevButton.disabled = currentQuestion === 0;
            nextButton.textContent = currentQuestion === questions.length - 1 ? 'Finish' : 'Next';
            
            // Disable next button if no answer selected
            if (!userAnswers[questions[currentQuestion].id]) {
                nextButton.disabled = true;
            }
        }
        
        // Update progress indicator
        function updateProgressIndicator() {
            const dots = progressIndicator.querySelectorAll('.progress-dot');
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentQuestion);
            });
        }
        
        // Navigate to previous question
        function navigateToPrevious() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion(currentQuestion);
            }
        }
        
        // Navigate to next question
        function navigateToNext() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                renderQuestion(currentQuestion);
            } else {
                showResults();
            }
        }
        
        // Show results
        function showResults() {
            // Hide questions and navigation
            questionsContainer.style.display = 'none';
            prevButton.style.display = 'none';
            nextButton.style.display = 'none';
            
            // Show results container
            resultsContainer.classList.add('visible');
            
            // Determine sky personality based on answers
            const skyPersonality = determineSkyPersonality();
            
            // Update results content
            resultsIcon.textContent = skyPersonality.icon;
            resultsTitle.textContent = skyPersonality.name;
            resultsDescription.textContent = skyPersonality.description;
            
            // Create a final sky based on all answers
            createFinalSky();
        }
        
        // Determine sky personality based on answers
        function determineSkyPersonality() {
            // Default personality in case no match is found
            let bestMatch = {
                name: "Unique Atmosphere",
                description: "Your blend of choices creates a totally unique sky personality. Like a weather pattern never seen before, you bring something new to the world.",
                icon: "üå§Ô∏è",
                matchScore: 0
            };
            
            // Evaluate each profile for matching answers
            skyProfiles.forEach(profile => {
                let matchScore = 0;
                let totalPossibleMatches = 0;
                
                // Check each category in the profile
                for (const [category, values] of Object.entries(profile.matches)) {
                    totalPossibleMatches++;
                    
                    // If user answered this category and the answer is in the profile's values
                    if (userAnswers[category] && values.includes(userAnswers[category])) {
                        matchScore++;
                    }
                }
                
                // Calculate match percentage
                const matchPercentage = totalPossibleMatches > 0 ? 
                    matchScore / totalPossibleMatches : 0;
                
                // Update best match if this is better
                if (matchPercentage > bestMatch.matchScore) {
                    bestMatch = {
                        ...profile,
                        matchScore: matchPercentage
                    };
                }
            });
            
            return bestMatch;
        }
        
        // Create a final sky based on all answers
        function createFinalSky() {
            // Clear existing intervals
            if (window.rainInterval) clearInterval(window.rainInterval);
            if (window.snowInterval) clearInterval(window.snowInterval);
            if (window.lightningInterval) clearInterval(window.lightningInterval);
            
            // Based on time of day
            if (userAnswers.time === 'dawn') {
                skyCanvas.style.background = 'linear-gradient(to bottom, #ff9966, #ff5e62)';
                sun.style.opacity = 1;
                sun.style.left = '30%';
                sun.style.top = '20%';
                moon.style.opacity = 0;
            } else if (userAnswers.time === 'midday') {
                skyCanvas.style.background = 'linear-gradient(to bottom, #1e90ff, #87ceeb)';
                sun.style.opacity = 1;
                sun.style.left = '50%';
                sun.style.top = '15%';
                moon.style.opacity = 0;
            } else if (userAnswers.time === 'sunset') {
                skyCanvas.style.background = 'linear-gradient(to bottom, #ff7e5f, #feb47b)';
                sun.style.opacity = 1;
                sun.style.left = '70%';
                sun.style.top = '25%';
                moon.style.opacity = 0;
            } else if (userAnswers.time === 'night') {
                skyCanvas.style.background = 'linear-gradient(to bottom, #0f2027, #203a43, #2c5364)';
                sun.style.opacity = 0;
                moon.style.opacity = 1;
                moon.style.right = '40%';
                moon.style.top = '20%';
                
                // Add stars
                document.querySelectorAll('.star').forEach(star => {
                    star.style.opacity = 0.8;
                });
            }
            
            // Based on weather
            if (userAnswers.weather) {
                if (userAnswers.weather === 'cloudy') {
                    // Add clouds
                    for (let i = 0; i < 8; i++) {
                        const cloud = createCloud();
                        cloud.style.opacity = 0.8;
                    }
                } else if (userAnswers.weather === 'rainy') {
                    // Dark clouds and rain
                    for (let i = 0; i < 12; i++) {
                        const cloud = createCloud();
                        cloud.style.background = '#888';
                        cloud.style.opacity = 0.8;
                    }
                    
                    // Add rain
                    setInterval(() => {
                        const raindrop = createRaindrop();
                        raindrop.style.opacity = 0.7;
                        raindrop.style.animation = `rain ${Math.random() * 1 + 1}s linear`;
                        
                        setTimeout(() => {
                            if (raindrop.parentNode) {
                                raindrop.parentNode.removeChild(raindrop);
                            }
                        }, 2000);
                    }, 50);
                } else if (userAnswers.weather === 'stormy') {
                    // Dark clouds, rain and lightning
                    for (let i = 0; i < 15; i++) {
                        const cloud = createCloud();
                        cloud.style.background = '#555';
                        cloud.style.opacity = 0.9;
                    }
                    
                    // Add rain
                    setInterval(() => {
                        const raindrop = createRaindrop();
                        raindrop.style.opacity = 0.7;
                        raindrop.style.animation = `rain ${Math.random() * 1 + 0.8}s linear`;
                        
                        setTimeout(() => {
                            if (raindrop.parentNode) {
                                raindrop.parentNode.removeChild(raindrop);
                            }
                        }, 2000);
                    }, 30);
                    
                    // Add lightning
                    setInterval(() => {
                        if (Math.random() > 0.7) {
                            createLightning();
                        }
                    }, 2000);
                } else if (userAnswers.weather === 'snowy') {
                    // Light clouds and snow
                    for (let i = 0; i < 10; i++) {
                        const cloud = createCloud();
                        cloud.style.background = '#ccc';
                        cloud.style.opacity = 0.8;
                    }
                    
                    // Add snow
                    setInterval(() => {
                        const snowflake = createSnowflake();
                        snowflake.style.opacity = 0.9;
                        snowflake.style.animation = `snow ${Math.random() * 5 + 5}s linear`;
                        
                        setTimeout(() => {
                            if (snowflake.parentNode) {
                                snowflake.parentNode.removeChild(snowflake);
                            }
                        }, 10000);
                    }, 200);
                }
            }
            
            // Add rainbow if vibrant energy
            if (userAnswers.energy === 'vibrant') {
                rainbow.style.opacity = 0.7;
                rainbow.style.bottom = '20%';
            }
        }
        
        // Restart the quiz
        function restartQuiz() {
            // Reset state
            currentQuestion = 0;
            userAnswers = {};
            
            // Show questions and navigation again
            questionsContainer.style.display = 'block';
            prevButton.style.display = 'block';
            nextButton.style.display = 'block';
            
            // Hide results
            resultsContainer.classList.remove('visible');
            
            // Clear existing intervals
            if (window.rainInterval) clearInterval(window.rainInterval);
            if (window.snowInterval) clearInterval(window.snowInterval);
            if (window.lightningInterval) clearInterval(window.lightningInterval);
            
            // Reset sky
            skyCanvas.style.background = 'linear-gradient(to bottom, #1e3c72, #2a5298)';
            sun.style.opacity = 0;
            moon.style.opacity = 0;
            rainbow.style.opacity = 0;
            rainbow.style.bottom = '-150px';
            
            // Remove all weather elements
            document.querySelectorAll('.cloud, .raindrop, .snow, .lightning').forEach(el => {
                el.parentNode.removeChild(el);
            });
            
            // Reset stars
            document.querySelectorAll('.star').forEach(star => {
                star.style.opacity = 0;
            });
            
            // Create initial sky elements
            createInitialSkyElements();
            
            // Render first question
            renderQuestion(currentQuestion);
        }
        
        // Initialize the app
        initialize();
    });
    </script>
</body>
</html>
